{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2018-04-27---the-art-of-finding-a-lost-rubygem/","webpackCompilationHash":"4b79ab9d396b4209c45f","result":{"data":{"site":{"siteMetadata":{"title":"waiyanyoon.com","author":"Waiyan Yoon"}},"markdownRemark":{"id":"27627f72-3395-5a11-a1e7-c9ddb9662421","excerpt":"Context A project was remained almost untouched for a year and it was out of dust recently for migrating a deprecating API. For frontend project using React on…","html":"<h2>Context</h2>\n<p>A project was remained almost untouched for a year and it was out of dust recently for migrating a deprecating API. For frontend project using React on Ruby on Rails, things are moving fast enough that <a href=\"https://github.com/reactjs/react-rails\">react-rails</a> is no longer needed and <a href=\"https://github.com/rails/webpacker\">webpacker</a> is officially introduced to use ES6 and npm libraries for the frontend pages, all this within a year. A <a href=\"https://github.com/adazzle/react-data-grid\">react-data-grid</a> npm library was found and jquery is no more needed to make things work in jquery <a href=\"https://github.com/wenzhixin/bootstrap-table\">bootstrap-table</a> is no longer needed in a React ecosystem.</p>\n<p>Other than that, this project was using a fork of a Rails assets gem which contains the minified library of <code class=\"language-text\">react-bootstrap</code> npm library, which was removed from Github, and the <a href=\"https://github.com/mariopeixoto/react-bootstrap-rails\">original repo</a> remains unmantained. </p>\n<h2>Problem</h2>\n<p>We were forced to use the original repo of the gem but unfortunately there are <code class=\"language-text\">inputRef</code> errors in React Bootstrap which was hard to trace down. I asked the fork owner to recall what was changed to make it work, but we couldn’t trace down what was changed in the fork. </p>\n<h2>Solution</h2>\n<p>One great hint to the solution of the problem is that the project works on production, so I guess the repo is somewhere inside our production server. Right after this idea popped out my mind, I did a quick tour on the production server root and pry open the gem:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token assign-left variable\">EDITOR</span><span class=\"token operator\">=</span>vim bundle <span class=\"token function\">open</span> react-bootstrap-rails</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre class=\"language-vim\"><code class=\"language-vim\"><span class=\"token comment\">\" ============================================================================</span>\n<span class=\"token comment\">\" Netrw Directory Listing                                        (netrw v155)</span>\n<span class=\"token comment\">\"   /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d</span>\n<span class=\"token comment\">\"   Sorted by      name</span>\n<span class=\"token comment\">\"   Sort sequence: [\\/]$,\\&lt;core\\%(\\.\\d\\+\\)\\=\\>,\\.h$,\\.c$,\\.cpp$,\\~\\=\\*$,*,\\.o$,\\.obj$,\\.</span>\n<span class=\"token comment\">\"   Quick Help: &lt;F1>:help  -:go up dir  D:delete  R:rename  s:sort-by  x:special</span>\n<span class=\"token comment\">\" ==============================================================================</span>\n<span class=\"token operator\">.</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>\n<span class=\"token operator\">.</span><span class=\"token operator\">.</span><span class=\"token operator\">.</span></code></pre></div>\n<p>The directory of the gem shows up like a puzzle game. Changed my current working directory to the gem directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d</code></pre></div>\n<p>then checked the git log to trace the latest change.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> log</code></pre></div>\n<p>Bingo! This is the lost gem we’re trying to find:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">commit 025316434534db0514edf527f336ad8e8474437c1\nAuthor: The Fork Author &lt;author@email.com&gt;\nDate:   Fri Jan 6 16:20:46 2017 +0800\n\n    bump version to 0.30.7\n\ncommit 3870d765ed93d40537353216de3e36332223247b\nAuthor: Mario Peixoto &lt;mario.peixoto@gmail.com&gt;\nDate:   Thu Dec 29 15:57:40 2016 -0600\n\n    Adding warning to README</code></pre></div>\n<p>So I quickly copied the gem to my local:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">scp -r user@my.server.ip.address:/var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d ~/Desktop/</code></pre></div>\n<p>and source it in my project’s Gemfile:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">gem <span class=\"token string\">'react-bootstrap-rails'</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">:</span> <span class=\"token string\">'~/Desktop/react-bootstrap-rails-025316434534d'</span></code></pre></div>\n<p>now my local clone has finally worked! Later that I pushed the gem into a repo under the company’s ownership so that we could still use it internally without being dependent to external source.</p>\n<h2>Conclusion</h2>\n<p>The steps looks simple and trivial, but the whole process of seeking out the truth of broken frontend that’s hard to trace and the lost of art of the fork feels like a puzzle game for me solve. Certain level of fun is engaged which helps with the boredom of daily coding.</p>\n<p>Note: As you might have noticed, the exact path, project, and the information of the fork author are all modified and changed to preserve privacy.</p>","frontmatter":{"title":"The Art of Finding a Lost Ruby Gem","date":"April 27, 2018","description":"","tags":["rails","rubygem","ruby"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2018-04-27---the-art-of-finding-a-lost-rubygem/","previous":{"fields":{"slug":"/blog/2018-04-26---react-fragment/"},"frontmatter":{"title":"Use of React.Fragment"}},"next":{"fields":{"slug":"/blog/2018-05-02---convert-api-result-hash-to-ruby-objects/"},"frontmatter":{"title":"Convert API Result Hash to Ruby Objects"}}}}}