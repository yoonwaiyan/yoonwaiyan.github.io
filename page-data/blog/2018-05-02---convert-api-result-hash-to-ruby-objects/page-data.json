{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2018-05-02---convert-api-result-hash-to-ruby-objects/","webpackCompilationHash":"4aa33d3ddb7a5cd2b0ed","result":{"data":{"site":{"siteMetadata":{"title":"waiyanyoon.com","author":"Waiyan Yoon"}},"markdownRemark":{"id":"fe7c3436-107f-508e-b724-4365af6fc6ca","excerpt":"Note: Examples shown in this post are a fraction or a sample response returned from Lazada Open Platform: Without a sophisticated Ruby SDK, REST APIs return…","html":"<p>Note: Examples shown in this post are a fraction or a sample response returned from Lazada Open Platform:</p>\n<p>Without a sophisticated Ruby SDK, REST APIs return queries in JSON format. This is how we normally handle the results returned from API in Ruby:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"short_description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"richText\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Highlights\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"richText\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Product Description\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"video\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Video URL\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"brand\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"singleSelect\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Brand\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">{</span><span class=\"token string\">\"is_sale_prop\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"model\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"options\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"is_mandatory\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"attribute_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"normal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"label\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Model\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Take a look at the first element in the array:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token operator\">></span> a_hash <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>first\n<span class=\"token comment\"># => {\"is_sale_prop\"=>0, \"name\"=>\"name\", \"input_type\"=>\"text\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Name\"}</span></code></pre></div>\n<p>In this way the value <code class=\"language-text\">input_type</code> can be obtained by the hash key:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token operator\">></span> a_hash<span class=\"token punctuation\">[</span><span class=\"token string\">\"input_type\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># => \"text\"</span></code></pre></div>\n<p>This is acceptable in cases where the hash is not frequently being accessed. But in cases of heavy usage especially when processing multiple API results, you can make your code better or tidier by converting the API result from hash to an object:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token operator\">></span> category_attributes <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>to_json<span class=\"token punctuation\">,</span> object_class<span class=\"token punctuation\">:</span> <span class=\"token constant\">OpenStruct</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"name\", input_type=\"text\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Name\">,</span>\n <span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"short_description\", input_type=\"richText\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Highlights\">,</span>\n <span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"description\", input_type=\"richText\", options=[], is_mandatory=0, attribute_type=\"normal\", label=\"Product Description\">,</span>\n <span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"video\", input_type=\"text\", options=[], is_mandatory=0, attribute_type=\"normal\", label=\"Video URL\">,</span>\n <span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"brand\", input_type=\"singleSelect\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Brand\">,</span>\n <span class=\"token comment\">#&lt;OpenStruct is_sale_prop=0, name=\"model\", input_type=\"text\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Model\">]</span></code></pre></div>\n<p>Now we can access the attribute directly:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># get the value via object attribute</span>\n<span class=\"token operator\">></span> category_attributes<span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>input_type\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"text\"</span>\n\n<span class=\"token comment\"># you can treat it as a hash too</span>\n<span class=\"token operator\">></span> category_attributes<span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">[</span><span class=\"token string\">\"input_type\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"text\"</span></code></pre></div>\n<p>Sometimes you have API result which is returned as camel case, but snake case is the de facto standard in Ruby. The example below shows the that camel case is being used in some keys e.g. <code class=\"language-text\">Status</code>, <code class=\"language-text\">SellerSku</code> and <code class=\"language-text\">ShopSku</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">response <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"code\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">\"data\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span><span class=\"token string\">\"total_products\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">\"products\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"skus\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n       <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"Status\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"quantity\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"product_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.03\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Image2\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"SellerSku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"39817:01:01\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"ShopSku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"BU565ELAX8AGSGAMZ-1104491\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Url\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"https://alice.lazada.sg/asd-1083832.html\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_width\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-0300:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_from_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2015-07-3100:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_height\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"4.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_length\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.04\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Available\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_date\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-03\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"primary_category\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10000211\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"attributes\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token string\">\"short_description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Short Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"asd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"warranty_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"International Manufacturer\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"brand\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Asante\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     <span class=\"token punctuation\">{</span><span class=\"token string\">\"skus\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n       <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"Status\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"quantity\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"product_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.03\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Image2\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"SellerSku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"39817:01:01\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"ShopSku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"BU565ELAX8AGSGAMZ-1104491\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Url\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"https://alice.lazada.sg/asd-1083832.html\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_width\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-0300:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_from_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2015-07-3100:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_height\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"4.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_length\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.04\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"Available\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_date\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-03\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"primary_category\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10000211\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"attributes\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token string\">\"short_description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Short description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"asd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"warranty_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"International Manufacturer\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"brand\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Asante\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">\"request_id\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0ba2887315178178017221014\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>It’s totally fine if you want the hash keys to remain as camelcase, but if you want to convert the keys to snake case instead, Rails provides a helper to transform your hash keys to underscore:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token operator\">></span> response<span class=\"token punctuation\">.</span>deep_transform_keys <span class=\"token punctuation\">{</span> <span class=\"token operator\">|</span>key<span class=\"token operator\">|</span> key<span class=\"token punctuation\">.</span>to_s<span class=\"token punctuation\">.</span>underscore <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"code\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">\"data\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span><span class=\"token string\">\"total_products\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">\"products\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"skus\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n       <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"status\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"quantity\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"product_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.03\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"image2\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"seller_sku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"39817:01:01\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"shop_sku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"BU565ELAX8AGSGAMZ-1104491\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"url\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"https://alice.lazada.sg/asd-1083832.html\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_width\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-0300:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_from_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2015-07-3100:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_height\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"4.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_length\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.04\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"available\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_date\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-03\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"primary_category\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10000211\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"attributes\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token string\">\"short_description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Short Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"asd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"warranty_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"International Manufacturer\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"brand\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Asante\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     <span class=\"token punctuation\">{</span><span class=\"token string\">\"skus\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n       <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"status\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"quantity\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"product_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.03\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"image2\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"seller_sku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"39817:01:01\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"shop_sku\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"BU565ELAX8AGSGAMZ-1104491\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"url\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"https://alice.lazada.sg/asd-1083832.html\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_width\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-0300:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_from_time\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2015-07-3100:00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_height\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"4.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"price\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_length\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10.00\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"package_weight\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0.04\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"available\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">\"special_to_date\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"2020-02-03\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"primary_category\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"10000211\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"attributes\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token string\">\"short_description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Short description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"asd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"description\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"warranty_type\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"International Manufacturer\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"brand\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"Asante\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">\"request_id\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"0ba2887315178178017221014\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>These snippets comes in handy while dealing with external APIs which the response returned is not under control. While using hash or keys with camel case won’t cause any problem, but it might somehow hurt the readability of the code when hash is frequently being used while processing the response, which happened in one of our project. Converting the hash to object is recommended unless memory and performance tweaking is in priority.</p>\n<h2>External reading</h2>\n<ol>\n<li><a href=\"https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object\">https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8706930/converting-nested-hash-keys-from-camelcase-to-snake-case-in-ruby/40093995?noredirect=1#comment72573345_40093995\">https://stackoverflow.com/questions/8706930/converting-nested-hash-keys-from-camelcase-to-snake-case-in-ruby/40093995?noredirect=1#comment72573345_40093995</a></li>\n</ol>","frontmatter":{"title":"Convert API Result Hash to Ruby Objects","date":"May 02, 2018","description":"","tags":["rails","ruby","api","json"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2018-05-02---convert-api-result-hash-to-ruby-objects/","previous":{"fields":{"slug":"/blog/2018-04-27---the-art-of-finding-a-lost-rubygem/"},"frontmatter":{"title":"The Art of Finding a Lost Ruby Gem"}},"next":{"fields":{"slug":"/blog/2018-06-08---understanding-basics-of-react-context/"},"frontmatter":{"title":"Understanding Basics of React Context"}}}}}