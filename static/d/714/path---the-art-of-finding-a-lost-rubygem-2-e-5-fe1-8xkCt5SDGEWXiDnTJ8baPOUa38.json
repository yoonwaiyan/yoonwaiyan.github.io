{"data":{"ghostPost":{"id":"Ghost__Post__5ae3138ebd54885f9208928f","title":"The Art of Finding a Lost Ruby Gem","slug":"the-art-of-finding-a-lost-rubygem","featured":false,"feature_image":null,"excerpt":"This post shares how a forked gem was found in a place that has replicated the fork, which was removed some while ago from the remote source, Github.","custom_excerpt":"This post shares how a forked gem was found in a place that has replicated the fork, which was removed some while ago from the remote source, Github.","created_at_pretty":"27 April, 2018","published_at_pretty":"27 April, 2018","updated_at_pretty":"27 April, 2018","created_at":"2018-04-27T20:11:58.000+08:00","published_at":"2018-04-27T21:30:42.000+08:00","updated_at":"2018-04-27T21:54:10.000+08:00","meta_title":null,"meta_description":null,"og_description":null,"og_image":null,"og_title":null,"twitter_description":null,"twitter_image":null,"twitter_title":null,"authors":[{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"rails","slug":"rails","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},"tags":[{"name":"rails","slug":"rails","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"rubygem","slug":"rubygem","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"ruby","slug":"ruby","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"}],"plaintext":"Context\nA project was remained almost untouched for a year and it was out of dust\nrecently for migrating a deprecating API. For frontend project using React on\nRuby on Rails, things are moving fast enough that react-rails\n[https://github.com/reactjs/react-rails]  is no longer needed and webpacker\n[https://github.com/rails/webpacker]  is officially introduced to use ES6 and\nnpm libraries for the frontend pages, all this within a year. A react-data-grid\n[https://github.com/adazzle/react-data-grid]  npm library was found and jquery\nis no more needed to make things work in jquery bootstrap-table\n[https://github.com/wenzhixin/bootstrap-table]  is no longer needed in a React\necosystem.\n\nOther than that, this project was using a fork of a Rails assets gem which\ncontains the minified library of react-bootstrap  npm library, which was removed\nfrom Github, and the original repo\n[https://github.com/mariopeixoto/react-bootstrap-rails]  remains unmantained.\n\nProblem\nWe were forced to use the original repo of the gem but unfortunately there are \ninputRef  errors in React Bootstrap which was hard to trace down. I asked the\nfork owner to recall what was changed to make it work, but we couldn't trace\ndown what was changed in the fork.\n\nSolution\nOne great hint to the solution of the problem is that the project works on\nproduction, so I guess the repo is somewhere inside our production server. Right\nafter this idea popped out my mind, I did a quick tour on the production server\nroot and pry open the gem:\n\n$ EDITOR=vim bundle open react-bootstrap-rails\n\n\n\" ============================================================================\n\" Netrw Directory Listing                                        (netrw v155)\n\"   /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n\"   Sorted by      name\n\"   Sort sequence: [\\/]$,\\<core\\%(\\.\\d\\+\\)\\=\\>,\\.h$,\\.c$,\\.cpp$,\\~\\=\\*$,*,\\.o$,\\.obj$,\\.\n\"   Quick Help: <F1>:help  -:go up dir  D:delete  R:rename  s:sort-by  x:special\n\" ==============================================================================\n../\n...\n\n\nThe directory of the gem shows up like a puzzle game. Changed my current working\ndirectory to the gem directory:\n\n$ cd /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n\n\nthen checked the git log to trace the latest change.\n\n$ git log\n\n\nBingo! This is the lost gem we're trying to find:\n\ncommit 025316434534db0514edf527f336ad8e8474437c1\nAuthor: The Fork Author <author@email.com>\nDate:   Fri Jan 6 16:20:46 2017 +0800\n\n    bump version to 0.30.7\n\ncommit 3870d765ed93d40537353216de3e36332223247b\nAuthor: Mario Peixoto <mario.peixoto@gmail.com>\nDate:   Thu Dec 29 15:57:40 2016 -0600\n\n    Adding warning to README\n\n\n\nSo I quickly copied the gem to my local:\n\nscp -r user@my.server.ip.address:/var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d ~/Desktop/\n\n\nand source it in my project's Gemfile:\n\ngem 'react-bootstrap-rails', path: '~/Desktop/react-bootstrap-rails-025316434534d'\n\n\nnow my local clone has finally worked! Later that I pushed the gem into a repo\nunder the company's ownership so that we could still use it internally without\nbeing dependent to external source.\n\nConclusion\nThe steps looks simple and trivial, but the whole process of seeking out the\ntruth of broken frontend that's hard to trace and the lost of art of the fork\nfeels like a puzzle game for me solve. Certain level of fun is engaged which\nhelps with the boredom of daily coding.\n\nNote: As you might have noticed, the exact path, project, and the information of\nthe fork author are all modified and changed to preserve privacy.","html":"<h2 id=\"context\">Context</h2>\n<p>A project was remained almost untouched for a year and it was out of dust recently for migrating a deprecating API. For frontend project using React on Ruby on Rails, things are moving fast enough that <a href=\"https://github.com/reactjs/react-rails\">react-rails</a> is no longer needed and <a href=\"https://github.com/rails/webpacker\">webpacker</a> is officially introduced to use ES6 and npm libraries for the frontend pages, all this within a year. A <a href=\"https://github.com/adazzle/react-data-grid\">react-data-grid</a> npm library was found and jquery is no more needed to make things work in jquery <a href=\"https://github.com/wenzhixin/bootstrap-table\">bootstrap-table</a> is no longer needed in a React ecosystem.</p>\n<p>Other than that, this project was using a fork of a Rails assets gem which contains the minified library of <code>react-bootstrap</code> npm library, which was removed from Github, and the <a href=\"https://github.com/mariopeixoto/react-bootstrap-rails\">original repo</a> remains unmantained.</p>\n<h2 id=\"problem\">Problem</h2>\n<p>We were forced to use the original repo of the gem but unfortunately there are <code>inputRef</code> errors in React Bootstrap which was hard to trace down. I asked the fork owner to recall what was changed to make it work, but we couldn't trace down what was changed in the fork.</p>\n<h2 id=\"solution\">Solution</h2>\n<p>One great hint to the solution of the problem is that the project works on production, so I guess the repo is somewhere inside our production server. Right after this idea popped out my mind, I did a quick tour on the production server root and pry open the gem:</p>\n<pre><code class=\"language-bash\">$ EDITOR=vim bundle open react-bootstrap-rails\n</code></pre>\n<pre><code class=\"language-vim\">&quot; ============================================================================\n&quot; Netrw Directory Listing                                        (netrw v155)\n&quot;   /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n&quot;   Sorted by      name\n&quot;   Sort sequence: [\\/]$,\\&lt;core\\%(\\.\\d\\+\\)\\=\\&gt;,\\.h$,\\.c$,\\.cpp$,\\~\\=\\*$,*,\\.o$,\\.obj$,\\.\n&quot;   Quick Help: &lt;F1&gt;:help  -:go up dir  D:delete  R:rename  s:sort-by  x:special\n&quot; ==============================================================================\n../\n...\n</code></pre>\n<p>The directory of the gem shows up like a puzzle game. Changed my current working directory to the gem directory:</p>\n<pre><code class=\"language-bash\">$ cd /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n</code></pre>\n<p>then checked the git log to trace the latest change.</p>\n<pre><code class=\"language-bash\">$ git log\n</code></pre>\n<p>Bingo! This is the lost gem we're trying to find:</p>\n<pre><code>commit 025316434534db0514edf527f336ad8e8474437c1\nAuthor: The Fork Author &lt;author@email.com&gt;\nDate:   Fri Jan 6 16:20:46 2017 +0800\n\n    bump version to 0.30.7\n\ncommit 3870d765ed93d40537353216de3e36332223247b\nAuthor: Mario Peixoto &lt;mario.peixoto@gmail.com&gt;\nDate:   Thu Dec 29 15:57:40 2016 -0600\n\n    Adding warning to README\n\n</code></pre>\n<p>So I quickly copied the gem to my local:</p>\n<pre><code>scp -r user@my.server.ip.address:/var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d ~/Desktop/\n</code></pre>\n<p>and source it in my project's Gemfile:</p>\n<pre><code class=\"language-ruby\">gem 'react-bootstrap-rails', path: '~/Desktop/react-bootstrap-rails-025316434534d'\n</code></pre>\n<p>now my local clone has finally worked! Later that I pushed the gem into a repo under the company's ownership so that we could still use it internally without being dependent to external source.</p>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>The steps looks simple and trivial, but the whole process of seeking out the truth of broken frontend that's hard to trace and the lost of art of the fork feels like a puzzle game for me solve. Certain level of fun is engaged which helps with the boredom of daily coding.</p>\n<p>Note: As you might have noticed, the exact path, project, and the information of the fork author are all modified and changed to preserve privacy.</p>\n","url":"http://waiyanyoon.com/the-art-of-finding-a-lost-rubygem/","uuid":"6b3fd3ee-a508-4a07-bec4-07244ad0bd5e","page":false,"codeinjection_foot":"","codeinjection_head":"","comment_id":"5ae3138ebd54885f9208928f"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"the-art-of-finding-a-lost-rubygem"}}