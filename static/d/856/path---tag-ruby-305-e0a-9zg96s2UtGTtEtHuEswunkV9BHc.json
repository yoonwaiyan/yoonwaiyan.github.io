{"data":{"ghostTag":{"slug":"ruby","name":"ruby","visibility":"public","feature_image":null,"description":null,"meta_title":null,"meta_description":null},"allGhostPost":{"edges":[{"node":{"id":"Ghost__Post__5ae9be9ebd54885f92089298","title":"Convert API Result Hash to Ruby Objects","slug":"convert-api-result-hash-to-ruby-objects","featured":false,"feature_image":null,"excerpt":"This post shows how API result returned in hash in Ruby is better when it's converted to objects, and formatting camel case hash keys to use snake case using a Rails helper method to make it more Ruby-ish.","custom_excerpt":"This post shows how API result returned in hash in Ruby is better when it's converted to objects, and formatting camel case hash keys to use snake case using a Rails helper method to make it more Ruby-ish.","created_at_pretty":"02 May, 2018","published_at_pretty":"02 May, 2018","updated_at_pretty":"02 May, 2018","created_at":"2018-05-02T21:35:26.000+08:00","published_at":"2018-05-02T22:40:20.000+08:00","updated_at":"2018-05-02T22:45:34.000+08:00","meta_title":null,"meta_description":null,"og_description":null,"og_image":null,"og_title":null,"twitter_description":null,"twitter_image":null,"twitter_title":null,"authors":[{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"ruby","slug":"ruby","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},"tags":[{"name":"ruby","slug":"ruby","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"rails","slug":"rails","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"api","slug":"api","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"json","slug":"json","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"}],"plaintext":"Note: Examples shown in this post are a fraction or a sample response returned\nfrom Lazada Open Platform:\n\nWithout a sophisticated Ruby SDK, REST APIs return queries in JSON format. This\nis how we normally handle the results returned from API in Ruby:\n\nresult = [{\"is_sale_prop\"=>0, \"name\"=>\"name\", \"input_type\"=>\"text\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Name\"},\n {\"is_sale_prop\"=>0, \"name\"=>\"short_description\", \"input_type\"=>\"richText\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Highlights\"},\n {\"is_sale_prop\"=>0, \"name\"=>\"description\", \"input_type\"=>\"richText\", \"options\"=>[], \"is_mandatory\"=>0, \"attribute_type\"=>\"normal\", \"label\"=>\"Product Description\"},\n {\"is_sale_prop\"=>0, \"name\"=>\"video\", \"input_type\"=>\"text\", \"options\"=>[], \"is_mandatory\"=>0, \"attribute_type\"=>\"normal\", \"label\"=>\"Video URL\"},\n {\"is_sale_prop\"=>0, \"name\"=>\"brand\", \"input_type\"=>\"singleSelect\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Brand\"},\n {\"is_sale_prop\"=>0, \"name\"=>\"model\", \"input_type\"=>\"text\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Model\"}]\n\n\nTake a look at the first element in the array:\n\n> a_hash = result.first\n# => {\"is_sale_prop\"=>0, \"name\"=>\"name\", \"input_type\"=>\"text\", \"options\"=>[], \"is_mandatory\"=>1, \"attribute_type\"=>\"normal\", \"label\"=>\"Name\"}\n\n\nIn this way the value input_type  can be obtained by the hash key:\n\n> a_hash[\"input_type\"]\n# => \"text\"\n\n\nThis is acceptable in cases where the hash is not frequently being accessed. But\nin cases of heavy usage especially when processing multiple API results, you can\nmake your code better or tidier by converting the API result from hash to an\nobject:\n\n> category_attributes = JSON.parse(result.to_json, object_class: OpenStruct)\n=> [#<OpenStruct is_sale_prop=0, name=\"name\", input_type=\"text\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Name\">,\n #<OpenStruct is_sale_prop=0, name=\"short_description\", input_type=\"richText\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Highlights\">,\n #<OpenStruct is_sale_prop=0, name=\"description\", input_type=\"richText\", options=[], is_mandatory=0, attribute_type=\"normal\", label=\"Product Description\">,\n #<OpenStruct is_sale_prop=0, name=\"video\", input_type=\"text\", options=[], is_mandatory=0, attribute_type=\"normal\", label=\"Video URL\">,\n #<OpenStruct is_sale_prop=0, name=\"brand\", input_type=\"singleSelect\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Brand\">,\n #<OpenStruct is_sale_prop=0, name=\"model\", input_type=\"text\", options=[], is_mandatory=1, attribute_type=\"normal\", label=\"Model\">]\n\n\nNow we can access the attribute directly:\n\n# get the value via object attribute\n> category_attributes.first.input_type\n=> \"text\"\n\n# you can treat it as a hash too\n> category_attributes.first[\"input_type\"]\n=> \"text\"\n\n\nSometimes you have API result which is returned as camel case, but snake case is\nthe de facto standard in Ruby. The example below shows the that camel case is\nbeing used in some keys e.g. Status, SellerSku  and ShopSku.\n\nresponse = {\"code\"=>\"0\",\n \"data\"=>\n  {\"total_products\"=>\"10\",\n   \"products\"=>\n    [{\"skus\"=>\n       [{\"Status\"=>\"active\",\n         \"quantity\"=>0,\n         \"product_weight\"=>\"0.03\",\n         \"Image2\"=>\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\",\n         \"SellerSku\"=>\"39817:01:01\",\n         \"ShopSku\"=>\"BU565ELAX8AGSGAMZ-1104491\",\n         \"Url\"=>\"https://alice.lazada.sg/asd-1083832.html\",\n         \"package_width\"=>\"10.00\",\n         \"special_to_time\"=>\"2020-02-0300:00\",\n         \"special_from_time\"=>\"2015-07-3100:00\",\n         \"package_height\"=>\"4.00\",\n         \"special_price\"=>9,\n         \"price\"=>32,\n         \"package_length\"=>\"10.00\",\n         \"package_weight\"=>\"0.04\",\n         \"Available\"=>0,\n         \"special_to_date\"=>\"2020-02-03\"}],\n      \"primary_category\"=>\"10000211\",\n      \"attributes\"=>{\"short_description\"=>\"Short Description\", \"name\"=>\"asd\", \"description\"=>\"Description\", \"warranty_type\"=>\"International Manufacturer\", \"brand\"=>\"Asante\"}},\n     {\"skus\"=>\n       [{\"Status\"=>\"active\",\n         \"quantity\"=>0,\n         \"product_weight\"=>\"0.03\",\n         \"Image2\"=>\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\",\n         \"SellerSku\"=>\"39817:01:01\",\n         \"ShopSku\"=>\"BU565ELAX8AGSGAMZ-1104491\",\n         \"Url\"=>\"https://alice.lazada.sg/asd-1083832.html\",\n         \"package_width\"=>\"10.00\",\n         \"special_to_time\"=>\"2020-02-0300:00\",\n         \"special_from_time\"=>\"2015-07-3100:00\",\n         \"package_height\"=>\"4.00\",\n         \"special_price\"=>9,\n         \"price\"=>32,\n         \"package_length\"=>\"10.00\",\n         \"package_weight\"=>\"0.04\",\n         \"Available\"=>0,\n         \"special_to_date\"=>\"2020-02-03\"}],\n      \"primary_category\"=>\"10000211\",\n      \"attributes\"=>{\"short_description\"=>\"Short description\", \"name\"=>\"asd\", \"description\"=>\"Description\", \"warranty_type\"=>\"International Manufacturer\", \"brand\"=>\"Asante\"}}]},\n \"request_id\"=>\"0ba2887315178178017221014\"}\n\n\nIt's totally fine if you want the hash keys to remain as camelcase, but if you\nwant to convert the keys to snake case instead, Rails provides a helper to\ntransform your hash keys to underscore:\n\n> response.deep_transform_keys { |key| key.to_s.underscore }\n=> {\"code\"=>\"0\",\n \"data\"=>\n  {\"total_products\"=>\"10\",\n   \"products\"=>\n    [{\"skus\"=>\n       [{\"status\"=>\"active\",\n         \"quantity\"=>0,\n         \"product_weight\"=>\"0.03\",\n         \"image2\"=>\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\",\n         \"seller_sku\"=>\"39817:01:01\",\n         \"shop_sku\"=>\"BU565ELAX8AGSGAMZ-1104491\",\n         \"url\"=>\"https://alice.lazada.sg/asd-1083832.html\",\n         \"package_width\"=>\"10.00\",\n         \"special_to_time\"=>\"2020-02-0300:00\",\n         \"special_from_time\"=>\"2015-07-3100:00\",\n         \"package_height\"=>\"4.00\",\n         \"special_price\"=>9,\n         \"price\"=>32,\n         \"package_length\"=>\"10.00\",\n         \"package_weight\"=>\"0.04\",\n         \"available\"=>0,\n         \"special_to_date\"=>\"2020-02-03\"}],\n      \"primary_category\"=>\"10000211\",\n      \"attributes\"=>{\"short_description\"=>\"Short Description\", \"name\"=>\"asd\", \"description\"=>\"Description\", \"warranty_type\"=>\"International Manufacturer\", \"brand\"=>\"Asante\"}},\n     {\"skus\"=>\n       [{\"status\"=>\"active\",\n         \"quantity\"=>0,\n         \"product_weight\"=>\"0.03\",\n         \"image2\"=>\"http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg\",\n         \"seller_sku\"=>\"39817:01:01\",\n         \"shop_sku\"=>\"BU565ELAX8AGSGAMZ-1104491\",\n         \"url\"=>\"https://alice.lazada.sg/asd-1083832.html\",\n         \"package_width\"=>\"10.00\",\n         \"special_to_time\"=>\"2020-02-0300:00\",\n         \"special_from_time\"=>\"2015-07-3100:00\",\n         \"package_height\"=>\"4.00\",\n         \"special_price\"=>9,\n         \"price\"=>32,\n         \"package_length\"=>\"10.00\",\n         \"package_weight\"=>\"0.04\",\n         \"available\"=>0,\n         \"special_to_date\"=>\"2020-02-03\"}],\n      \"primary_category\"=>\"10000211\",\n      \"attributes\"=>{\"short_description\"=>\"Short description\", \"name\"=>\"asd\", \"description\"=>\"Description\", \"warranty_type\"=>\"International Manufacturer\", \"brand\"=>\"Asante\"}}]},\n \"request_id\"=>\"0ba2887315178178017221014\"}\n\n\nThese snippets comes in handy while dealing with external APIs which the\nresponse returned is not under control. While using hash or keys with camel case\nwon't cause any problem, but it might somehow hurt the readability of the code\nwhen hash is frequently being used while processing the response, which happened\nin one of our project. Converting the hash to object is recommended unless\nmemory and performance tweaking is in priority.\n\nExternal reading\n 1. https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object\n 2. https://stackoverflow.com/questions/8706930/converting-nested-hash-keys-from-camelcase-to-snake-case-in-ruby/40093995?noredirect=1#comment72573345_40093995","html":"<p>Note: Examples shown in this post are a fraction or a sample response returned from Lazada Open Platform:</p>\n<p>Without a sophisticated Ruby SDK, REST APIs return queries in JSON format. This is how we normally handle the results returned from API in Ruby:</p>\n<pre><code class=\"language-ruby\">result = [{&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;name&quot;, &quot;input_type&quot;=&gt;&quot;text&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;1, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Name&quot;},\n {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;short_description&quot;, &quot;input_type&quot;=&gt;&quot;richText&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;1, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Highlights&quot;},\n {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;description&quot;, &quot;input_type&quot;=&gt;&quot;richText&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;0, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Product Description&quot;},\n {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;video&quot;, &quot;input_type&quot;=&gt;&quot;text&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;0, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Video URL&quot;},\n {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;brand&quot;, &quot;input_type&quot;=&gt;&quot;singleSelect&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;1, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Brand&quot;},\n {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;model&quot;, &quot;input_type&quot;=&gt;&quot;text&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;1, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Model&quot;}]\n</code></pre>\n<p>Take a look at the first element in the array:</p>\n<pre><code class=\"language-ruby\">&gt; a_hash = result.first\n# =&gt; {&quot;is_sale_prop&quot;=&gt;0, &quot;name&quot;=&gt;&quot;name&quot;, &quot;input_type&quot;=&gt;&quot;text&quot;, &quot;options&quot;=&gt;[], &quot;is_mandatory&quot;=&gt;1, &quot;attribute_type&quot;=&gt;&quot;normal&quot;, &quot;label&quot;=&gt;&quot;Name&quot;}\n</code></pre>\n<p>In this way the value <code>input_type</code> can be obtained by the hash key:</p>\n<pre><code class=\"language-ruby\">&gt; a_hash[&quot;input_type&quot;]\n# =&gt; &quot;text&quot;\n</code></pre>\n<p>This is acceptable in cases where the hash is not frequently being accessed. But in cases of heavy usage especially when processing multiple API results, you can make your code better or tidier by converting the API result from hash to an object:</p>\n<pre><code class=\"language-ruby\">&gt; category_attributes = JSON.parse(result.to_json, object_class: OpenStruct)\n=&gt; [#&lt;OpenStruct is_sale_prop=0, name=&quot;name&quot;, input_type=&quot;text&quot;, options=[], is_mandatory=1, attribute_type=&quot;normal&quot;, label=&quot;Name&quot;&gt;,\n #&lt;OpenStruct is_sale_prop=0, name=&quot;short_description&quot;, input_type=&quot;richText&quot;, options=[], is_mandatory=1, attribute_type=&quot;normal&quot;, label=&quot;Highlights&quot;&gt;,\n #&lt;OpenStruct is_sale_prop=0, name=&quot;description&quot;, input_type=&quot;richText&quot;, options=[], is_mandatory=0, attribute_type=&quot;normal&quot;, label=&quot;Product Description&quot;&gt;,\n #&lt;OpenStruct is_sale_prop=0, name=&quot;video&quot;, input_type=&quot;text&quot;, options=[], is_mandatory=0, attribute_type=&quot;normal&quot;, label=&quot;Video URL&quot;&gt;,\n #&lt;OpenStruct is_sale_prop=0, name=&quot;brand&quot;, input_type=&quot;singleSelect&quot;, options=[], is_mandatory=1, attribute_type=&quot;normal&quot;, label=&quot;Brand&quot;&gt;,\n #&lt;OpenStruct is_sale_prop=0, name=&quot;model&quot;, input_type=&quot;text&quot;, options=[], is_mandatory=1, attribute_type=&quot;normal&quot;, label=&quot;Model&quot;&gt;]\n</code></pre>\n<p>Now we can access the attribute directly:</p>\n<pre><code class=\"language-ruby\"># get the value via object attribute\n&gt; category_attributes.first.input_type\n=&gt; &quot;text&quot;\n\n# you can treat it as a hash too\n&gt; category_attributes.first[&quot;input_type&quot;]\n=&gt; &quot;text&quot;\n</code></pre>\n<p>Sometimes you have API result which is returned as camel case, but snake case is the de facto standard in Ruby. The example below shows the that camel case is being used in some keys e.g. <code>Status</code>, <code>SellerSku</code> and <code>ShopSku</code>.</p>\n<pre><code class=\"language-ruby\">response = {&quot;code&quot;=&gt;&quot;0&quot;,\n &quot;data&quot;=&gt;\n  {&quot;total_products&quot;=&gt;&quot;10&quot;,\n   &quot;products&quot;=&gt;\n    [{&quot;skus&quot;=&gt;\n       [{&quot;Status&quot;=&gt;&quot;active&quot;,\n         &quot;quantity&quot;=&gt;0,\n         &quot;product_weight&quot;=&gt;&quot;0.03&quot;,\n         &quot;Image2&quot;=&gt;&quot;http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg&quot;,\n         &quot;SellerSku&quot;=&gt;&quot;39817:01:01&quot;,\n         &quot;ShopSku&quot;=&gt;&quot;BU565ELAX8AGSGAMZ-1104491&quot;,\n         &quot;Url&quot;=&gt;&quot;https://alice.lazada.sg/asd-1083832.html&quot;,\n         &quot;package_width&quot;=&gt;&quot;10.00&quot;,\n         &quot;special_to_time&quot;=&gt;&quot;2020-02-0300:00&quot;,\n         &quot;special_from_time&quot;=&gt;&quot;2015-07-3100:00&quot;,\n         &quot;package_height&quot;=&gt;&quot;4.00&quot;,\n         &quot;special_price&quot;=&gt;9,\n         &quot;price&quot;=&gt;32,\n         &quot;package_length&quot;=&gt;&quot;10.00&quot;,\n         &quot;package_weight&quot;=&gt;&quot;0.04&quot;,\n         &quot;Available&quot;=&gt;0,\n         &quot;special_to_date&quot;=&gt;&quot;2020-02-03&quot;}],\n      &quot;primary_category&quot;=&gt;&quot;10000211&quot;,\n      &quot;attributes&quot;=&gt;{&quot;short_description&quot;=&gt;&quot;Short Description&quot;, &quot;name&quot;=&gt;&quot;asd&quot;, &quot;description&quot;=&gt;&quot;Description&quot;, &quot;warranty_type&quot;=&gt;&quot;International Manufacturer&quot;, &quot;brand&quot;=&gt;&quot;Asante&quot;}},\n     {&quot;skus&quot;=&gt;\n       [{&quot;Status&quot;=&gt;&quot;active&quot;,\n         &quot;quantity&quot;=&gt;0,\n         &quot;product_weight&quot;=&gt;&quot;0.03&quot;,\n         &quot;Image2&quot;=&gt;&quot;http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg&quot;,\n         &quot;SellerSku&quot;=&gt;&quot;39817:01:01&quot;,\n         &quot;ShopSku&quot;=&gt;&quot;BU565ELAX8AGSGAMZ-1104491&quot;,\n         &quot;Url&quot;=&gt;&quot;https://alice.lazada.sg/asd-1083832.html&quot;,\n         &quot;package_width&quot;=&gt;&quot;10.00&quot;,\n         &quot;special_to_time&quot;=&gt;&quot;2020-02-0300:00&quot;,\n         &quot;special_from_time&quot;=&gt;&quot;2015-07-3100:00&quot;,\n         &quot;package_height&quot;=&gt;&quot;4.00&quot;,\n         &quot;special_price&quot;=&gt;9,\n         &quot;price&quot;=&gt;32,\n         &quot;package_length&quot;=&gt;&quot;10.00&quot;,\n         &quot;package_weight&quot;=&gt;&quot;0.04&quot;,\n         &quot;Available&quot;=&gt;0,\n         &quot;special_to_date&quot;=&gt;&quot;2020-02-03&quot;}],\n      &quot;primary_category&quot;=&gt;&quot;10000211&quot;,\n      &quot;attributes&quot;=&gt;{&quot;short_description&quot;=&gt;&quot;Short description&quot;, &quot;name&quot;=&gt;&quot;asd&quot;, &quot;description&quot;=&gt;&quot;Description&quot;, &quot;warranty_type&quot;=&gt;&quot;International Manufacturer&quot;, &quot;brand&quot;=&gt;&quot;Asante&quot;}}]},\n &quot;request_id&quot;=&gt;&quot;0ba2887315178178017221014&quot;}\n</code></pre>\n<p>It's totally fine if you want the hash keys to remain as camelcase, but if you want to convert the keys to snake case instead, Rails provides a helper to transform your hash keys to underscore:</p>\n<pre><code class=\"language-ruby\">&gt; response.deep_transform_keys { |key| key.to_s.underscore }\n=&gt; {&quot;code&quot;=&gt;&quot;0&quot;,\n &quot;data&quot;=&gt;\n  {&quot;total_products&quot;=&gt;&quot;10&quot;,\n   &quot;products&quot;=&gt;\n    [{&quot;skus&quot;=&gt;\n       [{&quot;status&quot;=&gt;&quot;active&quot;,\n         &quot;quantity&quot;=&gt;0,\n         &quot;product_weight&quot;=&gt;&quot;0.03&quot;,\n         &quot;image2&quot;=&gt;&quot;http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg&quot;,\n         &quot;seller_sku&quot;=&gt;&quot;39817:01:01&quot;,\n         &quot;shop_sku&quot;=&gt;&quot;BU565ELAX8AGSGAMZ-1104491&quot;,\n         &quot;url&quot;=&gt;&quot;https://alice.lazada.sg/asd-1083832.html&quot;,\n         &quot;package_width&quot;=&gt;&quot;10.00&quot;,\n         &quot;special_to_time&quot;=&gt;&quot;2020-02-0300:00&quot;,\n         &quot;special_from_time&quot;=&gt;&quot;2015-07-3100:00&quot;,\n         &quot;package_height&quot;=&gt;&quot;4.00&quot;,\n         &quot;special_price&quot;=&gt;9,\n         &quot;price&quot;=&gt;32,\n         &quot;package_length&quot;=&gt;&quot;10.00&quot;,\n         &quot;package_weight&quot;=&gt;&quot;0.04&quot;,\n         &quot;available&quot;=&gt;0,\n         &quot;special_to_date&quot;=&gt;&quot;2020-02-03&quot;}],\n      &quot;primary_category&quot;=&gt;&quot;10000211&quot;,\n      &quot;attributes&quot;=&gt;{&quot;short_description&quot;=&gt;&quot;Short Description&quot;, &quot;name&quot;=&gt;&quot;asd&quot;, &quot;description&quot;=&gt;&quot;Description&quot;, &quot;warranty_type&quot;=&gt;&quot;International Manufacturer&quot;, &quot;brand&quot;=&gt;&quot;Asante&quot;}},\n     {&quot;skus&quot;=&gt;\n       [{&quot;status&quot;=&gt;&quot;active&quot;,\n         &quot;quantity&quot;=&gt;0,\n         &quot;product_weight&quot;=&gt;&quot;0.03&quot;,\n         &quot;image2&quot;=&gt;&quot;http://sg-live-01.slatic.net/p/BUYI1-catalog.jpg&quot;,\n         &quot;seller_sku&quot;=&gt;&quot;39817:01:01&quot;,\n         &quot;shop_sku&quot;=&gt;&quot;BU565ELAX8AGSGAMZ-1104491&quot;,\n         &quot;url&quot;=&gt;&quot;https://alice.lazada.sg/asd-1083832.html&quot;,\n         &quot;package_width&quot;=&gt;&quot;10.00&quot;,\n         &quot;special_to_time&quot;=&gt;&quot;2020-02-0300:00&quot;,\n         &quot;special_from_time&quot;=&gt;&quot;2015-07-3100:00&quot;,\n         &quot;package_height&quot;=&gt;&quot;4.00&quot;,\n         &quot;special_price&quot;=&gt;9,\n         &quot;price&quot;=&gt;32,\n         &quot;package_length&quot;=&gt;&quot;10.00&quot;,\n         &quot;package_weight&quot;=&gt;&quot;0.04&quot;,\n         &quot;available&quot;=&gt;0,\n         &quot;special_to_date&quot;=&gt;&quot;2020-02-03&quot;}],\n      &quot;primary_category&quot;=&gt;&quot;10000211&quot;,\n      &quot;attributes&quot;=&gt;{&quot;short_description&quot;=&gt;&quot;Short description&quot;, &quot;name&quot;=&gt;&quot;asd&quot;, &quot;description&quot;=&gt;&quot;Description&quot;, &quot;warranty_type&quot;=&gt;&quot;International Manufacturer&quot;, &quot;brand&quot;=&gt;&quot;Asante&quot;}}]},\n &quot;request_id&quot;=&gt;&quot;0ba2887315178178017221014&quot;}\n</code></pre>\n<p>These snippets comes in handy while dealing with external APIs which the response returned is not under control. While using hash or keys with camel case won't cause any problem, but it might somehow hurt the readability of the code when hash is frequently being used while processing the response, which happened in one of our project. Converting the hash to object is recommended unless memory and performance tweaking is in priority.</p>\n<h2 id=\"externalreading\">External reading</h2>\n<ol>\n<li><a href=\"https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object\">https://coderwall.com/p/74rajw/convert-a-complex-nested-hash-to-an-object</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8706930/converting-nested-hash-keys-from-camelcase-to-snake-case-in-ruby/40093995?noredirect=1#comment72573345_40093995\">https://stackoverflow.com/questions/8706930/converting-nested-hash-keys-from-camelcase-to-snake-case-in-ruby/40093995?noredirect=1#comment72573345_40093995</a></li>\n</ol>\n","url":"http://waiyanyoon.com/convert-api-result-hash-to-ruby-objects/","uuid":"98c3ff5c-33bb-4575-a719-be41c2b1f2bb","page":false,"codeinjection_foot":"","codeinjection_head":"","comment_id":"5ae9be9ebd54885f92089298"}},{"node":{"id":"Ghost__Post__5ae3138ebd54885f9208928f","title":"The Art of Finding a Lost Ruby Gem","slug":"the-art-of-finding-a-lost-rubygem","featured":false,"feature_image":null,"excerpt":"This post shares how a forked gem was found in a place that has replicated the fork, which was removed some while ago from the remote source, Github.","custom_excerpt":"This post shares how a forked gem was found in a place that has replicated the fork, which was removed some while ago from the remote source, Github.","created_at_pretty":"27 April, 2018","published_at_pretty":"27 April, 2018","updated_at_pretty":"27 April, 2018","created_at":"2018-04-27T20:11:58.000+08:00","published_at":"2018-04-27T21:30:42.000+08:00","updated_at":"2018-04-27T21:54:10.000+08:00","meta_title":null,"meta_description":null,"og_description":null,"og_image":null,"og_title":null,"twitter_description":null,"twitter_image":null,"twitter_title":null,"authors":[{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Yoon Wai Yan","slug":"yoonwaiyan","bio":null,"profile_image":"http://waiyanyoon.com/content/images/2018/04/yoonwaiyan-1.jpeg","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"rails","slug":"rails","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},"tags":[{"name":"rails","slug":"rails","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"rubygem","slug":"rubygem","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"},{"name":"ruby","slug":"ruby","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"public"}],"plaintext":"Context\nA project was remained almost untouched for a year and it was out of dust\nrecently for migrating a deprecating API. For frontend project using React on\nRuby on Rails, things are moving fast enough that react-rails\n[https://github.com/reactjs/react-rails]  is no longer needed and webpacker\n[https://github.com/rails/webpacker]  is officially introduced to use ES6 and\nnpm libraries for the frontend pages, all this within a year. A react-data-grid\n[https://github.com/adazzle/react-data-grid]  npm library was found and jquery\nis no more needed to make things work in jquery bootstrap-table\n[https://github.com/wenzhixin/bootstrap-table]  is no longer needed in a React\necosystem.\n\nOther than that, this project was using a fork of a Rails assets gem which\ncontains the minified library of react-bootstrap  npm library, which was removed\nfrom Github, and the original repo\n[https://github.com/mariopeixoto/react-bootstrap-rails]  remains unmantained.\n\nProblem\nWe were forced to use the original repo of the gem but unfortunately there are \ninputRef  errors in React Bootstrap which was hard to trace down. I asked the\nfork owner to recall what was changed to make it work, but we couldn't trace\ndown what was changed in the fork.\n\nSolution\nOne great hint to the solution of the problem is that the project works on\nproduction, so I guess the repo is somewhere inside our production server. Right\nafter this idea popped out my mind, I did a quick tour on the production server\nroot and pry open the gem:\n\n$ EDITOR=vim bundle open react-bootstrap-rails\n\n\n\" ============================================================================\n\" Netrw Directory Listing                                        (netrw v155)\n\"   /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n\"   Sorted by      name\n\"   Sort sequence: [\\/]$,\\<core\\%(\\.\\d\\+\\)\\=\\>,\\.h$,\\.c$,\\.cpp$,\\~\\=\\*$,*,\\.o$,\\.obj$,\\.\n\"   Quick Help: <F1>:help  -:go up dir  D:delete  R:rename  s:sort-by  x:special\n\" ==============================================================================\n../\n...\n\n\nThe directory of the gem shows up like a puzzle game. Changed my current working\ndirectory to the gem directory:\n\n$ cd /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n\n\nthen checked the git log to trace the latest change.\n\n$ git log\n\n\nBingo! This is the lost gem we're trying to find:\n\ncommit 025316434534db0514edf527f336ad8e8474437c1\nAuthor: The Fork Author <author@email.com>\nDate:   Fri Jan 6 16:20:46 2017 +0800\n\n    bump version to 0.30.7\n\ncommit 3870d765ed93d40537353216de3e36332223247b\nAuthor: Mario Peixoto <mario.peixoto@gmail.com>\nDate:   Thu Dec 29 15:57:40 2016 -0600\n\n    Adding warning to README\n\n\n\nSo I quickly copied the gem to my local:\n\nscp -r user@my.server.ip.address:/var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d ~/Desktop/\n\n\nand source it in my project's Gemfile:\n\ngem 'react-bootstrap-rails', path: '~/Desktop/react-bootstrap-rails-025316434534d'\n\n\nnow my local clone has finally worked! Later that I pushed the gem into a repo\nunder the company's ownership so that we could still use it internally without\nbeing dependent to external source.\n\nConclusion\nThe steps looks simple and trivial, but the whole process of seeking out the\ntruth of broken frontend that's hard to trace and the lost of art of the fork\nfeels like a puzzle game for me solve. Certain level of fun is engaged which\nhelps with the boredom of daily coding.\n\nNote: As you might have noticed, the exact path, project, and the information of\nthe fork author are all modified and changed to preserve privacy.","html":"<h2 id=\"context\">Context</h2>\n<p>A project was remained almost untouched for a year and it was out of dust recently for migrating a deprecating API. For frontend project using React on Ruby on Rails, things are moving fast enough that <a href=\"https://github.com/reactjs/react-rails\">react-rails</a> is no longer needed and <a href=\"https://github.com/rails/webpacker\">webpacker</a> is officially introduced to use ES6 and npm libraries for the frontend pages, all this within a year. A <a href=\"https://github.com/adazzle/react-data-grid\">react-data-grid</a> npm library was found and jquery is no more needed to make things work in jquery <a href=\"https://github.com/wenzhixin/bootstrap-table\">bootstrap-table</a> is no longer needed in a React ecosystem.</p>\n<p>Other than that, this project was using a fork of a Rails assets gem which contains the minified library of <code>react-bootstrap</code> npm library, which was removed from Github, and the <a href=\"https://github.com/mariopeixoto/react-bootstrap-rails\">original repo</a> remains unmantained.</p>\n<h2 id=\"problem\">Problem</h2>\n<p>We were forced to use the original repo of the gem but unfortunately there are <code>inputRef</code> errors in React Bootstrap which was hard to trace down. I asked the fork owner to recall what was changed to make it work, but we couldn't trace down what was changed in the fork.</p>\n<h2 id=\"solution\">Solution</h2>\n<p>One great hint to the solution of the problem is that the project works on production, so I guess the repo is somewhere inside our production server. Right after this idea popped out my mind, I did a quick tour on the production server root and pry open the gem:</p>\n<pre><code class=\"language-bash\">$ EDITOR=vim bundle open react-bootstrap-rails\n</code></pre>\n<pre><code class=\"language-vim\">&quot; ============================================================================\n&quot; Netrw Directory Listing                                        (netrw v155)\n&quot;   /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n&quot;   Sorted by      name\n&quot;   Sort sequence: [\\/]$,\\&lt;core\\%(\\.\\d\\+\\)\\=\\&gt;,\\.h$,\\.c$,\\.cpp$,\\~\\=\\*$,*,\\.o$,\\.obj$,\\.\n&quot;   Quick Help: &lt;F1&gt;:help  -:go up dir  D:delete  R:rename  s:sort-by  x:special\n&quot; ==============================================================================\n../\n...\n</code></pre>\n<p>The directory of the gem shows up like a puzzle game. Changed my current working directory to the gem directory:</p>\n<pre><code class=\"language-bash\">$ cd /var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d\n</code></pre>\n<p>then checked the git log to trace the latest change.</p>\n<pre><code class=\"language-bash\">$ git log\n</code></pre>\n<p>Bingo! This is the lost gem we're trying to find:</p>\n<pre><code>commit 025316434534db0514edf527f336ad8e8474437c1\nAuthor: The Fork Author &lt;author@email.com&gt;\nDate:   Fri Jan 6 16:20:46 2017 +0800\n\n    bump version to 0.30.7\n\ncommit 3870d765ed93d40537353216de3e36332223247b\nAuthor: Mario Peixoto &lt;mario.peixoto@gmail.com&gt;\nDate:   Thu Dec 29 15:57:40 2016 -0600\n\n    Adding warning to README\n\n</code></pre>\n<p>So I quickly copied the gem to my local:</p>\n<pre><code>scp -r user@my.server.ip.address:/var/www/the-project/shared/bundle/ruby/2.3.0/bundler/gems/react-bootstrap-rails-025316434534d ~/Desktop/\n</code></pre>\n<p>and source it in my project's Gemfile:</p>\n<pre><code class=\"language-ruby\">gem 'react-bootstrap-rails', path: '~/Desktop/react-bootstrap-rails-025316434534d'\n</code></pre>\n<p>now my local clone has finally worked! Later that I pushed the gem into a repo under the company's ownership so that we could still use it internally without being dependent to external source.</p>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>The steps looks simple and trivial, but the whole process of seeking out the truth of broken frontend that's hard to trace and the lost of art of the fork feels like a puzzle game for me solve. Certain level of fun is engaged which helps with the boredom of daily coding.</p>\n<p>Note: As you might have noticed, the exact path, project, and the information of the fork author are all modified and changed to preserve privacy.</p>\n","url":"http://waiyanyoon.com/the-art-of-finding-a-lost-rubygem/","uuid":"6b3fd3ee-a508-4a07-bec4-07244ad0bd5e","page":false,"codeinjection_foot":"","codeinjection_head":"","comment_id":"5ae3138ebd54885f9208928f"}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"ruby","limit":12,"skip":0,"numberOfPages":1,"humanPageNumber":1,"prevPageNumber":null,"nextPageNumber":null,"previousPagePath":null,"nextPagePath":null}}